{"remainingRequest":"/Users/halilibrahimguneri/Biges/sentinel-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/halilibrahimguneri/Biges/sentinel-frontend/src/components/list/device-report.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/halilibrahimguneri/Biges/sentinel-frontend/src/components/list/device-report.vue","mtime":1639036167632},{"path":"/Users/halilibrahimguneri/Biges/sentinel-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/halilibrahimguneri/Biges/sentinel-frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/halilibrahimguneri/Biges/sentinel-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/halilibrahimguneri/Biges/sentinel-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEFDVElPTlNfRklFTERTIH0gZnJvbSAiQC9jb25zdGFudCI7CmltcG9ydCBlbmRwb2ludHMgZnJvbSAiQC9lbmRwb2ludHMiOwppbXBvcnQgeyBidXMgfSBmcm9tICJAL21haW4uanMiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJEZXZpY2VSZXBvcnQiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0X3ZhbDogIiIsCiAgICAgIHR5cGU6ICIiLAogICAgICByZXNwb25zZV90eXBlOiAiIiwKICAgICAgc3RhcnRfdGltZTogIiIsCiAgICAgIGZpbmlzaF90aW1lOiAiIiwKICAgICAgdHlwZV9vcHRpb25zOiBbXSwKICAgICAgZm9ybWF0X29wdGlvbnM6IFtdLAogICAgICBsaXN0X29wdGlvbnM6IFtdLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBnZXRTZWxlY3RlZFJvd3NQcmVtaXNlSWQoKSB7CiAgICAgIGxldCBzZWxlY3RlZF9wcmVtaXNlX2lkcyA9IFtdOwogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5kYXRhVGFibGUuc2VsZWN0ZWRSb3dzLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICBzZWxlY3RlZF9wcmVtaXNlX2lkcy5wdXNoKGl0ZW0ucHJlbWlzZV9pZCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gc2VsZWN0ZWRfcHJlbWlzZV9pZHM7CiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlUmVwb3J0U3VibWl0KCkgewogICAgICBsZXQgZGV2aWNlc1ByZW1pc2VJRCA9IFtdOwogICAgICBsZXQgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOwogICAgICBpZiAodGhpcy5zdGFydF90aW1lID09ICIiIHx8IHRoaXMuZW5kX3RpbWUgPT0gIiIpIHsKICAgICAgICBsZXQgZW5kX3RpbWUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGxldCBzdGFydF90aW1lID0gbmV3IERhdGUoKTsKICAgICAgICBzdGFydF90aW1lLnNldERhdGUoZW5kX3RpbWUuZ2V0RGF0ZSgpIC0gMzApOwogICAgICAgIHRoaXMuZW5kX3RpbWUgPSBlbmRfdGltZS50b0lTT1N0cmluZygpOwogICAgICAgIHRoaXMuc3RhcnRfdGltZSA9IHN0YXJ0X3RpbWUudG9JU09TdHJpbmcoKTsKICAgICAgfQogICAgICBpZiAodGhpcy5saXN0X3ZhbCAhPSAiYWxsIikKICAgICAgICBkZXZpY2VzUHJlbWlzZUlEID0gdGhpcy5nZXRTZWxlY3RlZFJvd3NQcmVtaXNlSWQ7CiAgICAgIGVsc2UgZGV2aWNlc1ByZW1pc2VJRCA9IFtdOwogICAgICB0aGlzLiRhcGkoewogICAgICAgIC4uLmVuZHBvaW50cy5nZXREZXZpY2VSZXBvcnQsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICByZXNwb25zZV90eXBlOiB0aGlzLnJlc3BvbnNlX3R5cGUsCiAgICAgICAgICByZXBvcnRfdHlwZTogdGhpcy50eXBlLAogICAgICAgICAgc3RhcnRfdGltZTogdGhpcy5zdGFydF90aW1lLAogICAgICAgICAgZmluaXNoX3RpbWU6IHRoaXMuZmluaXNoX3RpbWUsCiAgICAgICAgICBwcmVtaXNlX2lkOiBkZXZpY2VzUHJlbWlzZUlELmpvaW4oKSwKICAgICAgICB9LAogICAgICB9KS50aGVuKChyKSA9PiB7CiAgICAgICAgaWYgKHIuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgY29uc29sZS5sb2cocik7CiAgICAgICAgICBjb25zdCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbci5kYXRhXSkpOwogICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKAogICAgICAgICAgICAiZG93bmxvYWQiLAogICAgICAgICAgICAiQ2loYXotcmFwb3JsYXJpLSIgKwogICAgICAgICAgICAgIGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCkgKwogICAgICAgICAgICAgICgiMCIgKyAoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEpKS5zbGljZSgtMikgKwogICAgICAgICAgICAgICgiMCIgKyBjdXJyZW50RGF0ZS5nZXREYXRlKCkpLnNsaWNlKC0yKSArCiAgICAgICAgICAgICAgKCIwIiArIGN1cnJlbnREYXRlLmdldEhvdXJzKCkpLnNsaWNlKC0yKSArCiAgICAgICAgICAgICAgKCIwIiArIGN1cnJlbnREYXRlLmdldE1pbnV0ZXMoKSkuc2xpY2UoLTIpICsKICAgICAgICAgICAgICAoIjAiICsgY3VycmVudERhdGUuZ2V0U2Vjb25kcygpKS5zbGljZSgtMikgKwogICAgICAgICAgICAgICIuIiArCiAgICAgICAgICAgICAgKHRoaXMucmVzcG9uc2VfdHlwZSA9PSAiZXhjZWwiID8gInhsc3giIDogdGhpcy5yZXNwb25zZV90eXBlKQogICAgICAgICAgKTsKICAgICAgICAgIC8vIGxpbmsuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsICdmaWxlLnhsc3gnKQogICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTsKICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgIGlmIChyLnN0YXR1cykgewogICAgICAgICAgICB0aGlzLiRlbWl0KCJvbkNsb3NlIik7CiAgICAgICAgICAgIHRoaXMubGlzdF92YWwgPSAiIjsKICAgICAgICAgICAgdGhpcy5zdGFydF90aW1lID0gIiI7CiAgICAgICAgICAgIHRoaXMuZmluaXNoX3RpbWUgPSAiIjsKICAgICAgICAgICAgdGhpcy50eXBlID0gIiI7CiAgICAgICAgICAgIHRoaXMucmVzcG9uc2VfdHlwZSA9ICIiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMubGlzdF9vcHRpb25zID0gWy4uLkFDVElPTlNfRklFTERTWyJSRVBPUlQiXVswXVsibGlzdCJdWyJvcHRpb25zIl1dOwogICAgdGhpcy50eXBlX29wdGlvbnMgPSBbLi4uQUNUSU9OU19GSUVMRFNbIlJFUE9SVCJdWzBdWyJ0eXBlIl1bIm9wdGlvbnMiXV07CiAgICB0aGlzLmZvcm1hdF9vcHRpb25zID0gWy4uLkFDVElPTlNfRklFTERTWyJSRVBPUlQiXVswXVsiZm9ybWF0Il1bIm9wdGlvbnMiXV07CiAgfSwKICBtb3VudGVkKCkgewogICAgYnVzLiRvbigib25SZXBvcnRTdWJtaXQiLCAodmFsKSA9PiB0aGlzLmhhbmRsZVJlcG9ydFN1Ym1pdCh2YWwpKTsKICB9LAp9Owo="},{"version":3,"sources":["device-report.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"device-report.vue","sourceRoot":"src/components/list","sourcesContent":["<template>\n  <div class=\"report-content\">\n    <div class=\"content\">\n      <span class=\"span-label\">LİSTE</span>\n      <el-select\n        style=\"width: 100%\"\n        v-model=\"list_val\"\n        placeholder=\"Seçiniz\"\n        clearable\n      >\n        <el-option\n          v-for=\"item in list_options\"\n          :key=\"item.value\"\n          :label=\"item.label\"\n          :value=\"item.value\"\n        >\n        </el-option>\n      </el-select>\n    </div>\n    <div class=\"content\">\n      <span class=\"span-label\">TÜR</span>\n      <el-select\n        style=\"width: 100%\"\n        v-model=\"type\"\n        placeholder=\"Seçiniz\"\n        clearable\n      >\n        <el-option\n          v-for=\"item in type_options\"\n          :key=\"item.value\"\n          :label=\"item.label\"\n          :value=\"item.value\"\n        >\n        </el-option>\n      </el-select>\n    </div>\n    <div class=\"content\">\n      <span class=\"span-label\">FORMAT</span>\n      <el-select\n        style=\"width: 100%\"\n        v-model=\"response_type\"\n        placeholder=\"Seçiniz\"\n        clearable\n      >\n        <el-option\n          v-for=\"item in format_options\"\n          :key=\"item.value\"\n          :label=\"item.label\"\n          :value=\"item.value\"\n        >\n        </el-option>\n      </el-select>\n    </div>\n    <div class=\"content\">\n      <span class=\"span-label\">BAŞLANGIÇ ZAMANI</span>\n      <el-date-picker\n        style=\"width: 100%\"\n        v-model=\"start_time\"\n        type=\"datetime\"\n        placeholder=\"Tarih ve Saat seçiniz\"\n      >\n      </el-date-picker>\n    </div>\n    <div class=\"content\">\n      <span class=\"span-label\">BİTİŞ ZAMANI</span>\n      <el-date-picker\n        style=\"width: 100%\"\n        v-model=\"finish_time\"\n        type=\"datetime\"\n        placeholder=\"Tarih ve Saat seçiniz\"\n      >\n      </el-date-picker>\n    </div>\n    <!-- <div class=\"save-button\">\n      <el-button type=\"primary\" @click=\"handleOnSaveClick\">Kaydet</el-button>\n    </div> -->\n  </div>\n</template>\n\n<script>\nimport { ACTIONS_FIELDS } from \"@/constant\";\nimport endpoints from \"@/endpoints\";\nimport { bus } from \"@/main.js\";\n\nexport default {\n  name: \"DeviceReport\",\n  data() {\n    return {\n      list_val: \"\",\n      type: \"\",\n      response_type: \"\",\n      start_time: \"\",\n      finish_time: \"\",\n      type_options: [],\n      format_options: [],\n      list_options: [],\n    };\n  },\n  computed: {\n    getSelectedRowsPremiseId() {\n      let selected_premise_ids = [];\n      this.$store.state.dataTable.selectedRows.forEach((item) => {\n        selected_premise_ids.push(item.premise_id);\n      });\n      return selected_premise_ids;\n    },\n  },\n  methods: {\n    handleReportSubmit() {\n      let devicesPremiseID = [];\n      let currentDate = new Date();\n      if (this.start_time == \"\" || this.end_time == \"\") {\n        let end_time = new Date();\n        let start_time = new Date();\n        start_time.setDate(end_time.getDate() - 30);\n        this.end_time = end_time.toISOString();\n        this.start_time = start_time.toISOString();\n      }\n      if (this.list_val != \"all\")\n        devicesPremiseID = this.getSelectedRowsPremiseId;\n      else devicesPremiseID = [];\n      this.$api({\n        ...endpoints.getDeviceReport,\n        params: {\n          response_type: this.response_type,\n          report_type: this.type,\n          start_time: this.start_time,\n          finish_time: this.finish_time,\n          premise_id: devicesPremiseID.join(),\n        },\n      }).then((r) => {\n        if (r.status == 200) {\n          console.log(r);\n          const url = window.URL.createObjectURL(new Blob([r.data]));\n          const link = document.createElement(\"a\");\n          link.href = url;\n          link.setAttribute(\n            \"download\",\n            \"Cihaz-raporlari-\" +\n              currentDate.getFullYear() +\n              (\"0\" + (currentDate.getMonth() + 1)).slice(-2) +\n              (\"0\" + currentDate.getDate()).slice(-2) +\n              (\"0\" + currentDate.getHours()).slice(-2) +\n              (\"0\" + currentDate.getMinutes()).slice(-2) +\n              (\"0\" + currentDate.getSeconds()).slice(-2) +\n              \".\" +\n              (this.response_type == \"excel\" ? \"xlsx\" : this.response_type)\n          );\n          // link.setAttribute('download', 'file.xlsx')\n          document.body.appendChild(link);\n          link.click();\n          if (r.status) {\n            this.$emit(\"onClose\");\n            this.list_val = \"\";\n            this.start_time = \"\";\n            this.finish_time = \"\";\n            this.type = \"\";\n            this.response_type = \"\";\n          }\n        }\n      });\n    },\n  },\n  created() {\n    this.list_options = [...ACTIONS_FIELDS[\"REPORT\"][0][\"list\"][\"options\"]];\n    this.type_options = [...ACTIONS_FIELDS[\"REPORT\"][0][\"type\"][\"options\"]];\n    this.format_options = [...ACTIONS_FIELDS[\"REPORT\"][0][\"format\"][\"options\"]];\n  },\n  mounted() {\n    bus.$on(\"onReportSubmit\", (val) => this.handleReportSubmit(val));\n  },\n};\n</script>\n\n<style></style>\n"]}]}